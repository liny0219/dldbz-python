# <center> dldbz-python
### <center>项目贡献者: 夜宵, GGBond, Wlog, 章鱼哥

#### 介绍
仅供交流学习用，请勿用于任何商业盈利

#### 更新说明
v2.6.2
修复黑龙盘更新后的选盘问题
设置增加端口设置按钮

v2.6.1
升级路口自定义规则,支持多个规则自动匹配
删除ocr预处理

v2.6.0
架构优化

v2.5.4
fix: 优化战斗逻辑,加快地图判断

v2.5.3
fix: 调整大富翁地图内检查逻辑,修复点击旅馆的对话导致重启

v2.5.2
调整统计信息展示

v2.5.1
在config/monopoly.json配置文件中增加是否开启识别敌人enemy_check配置 0 不开启,1开启

v2.5.0
在config/starup.json配置文件中增加package_name配置
OCR识别距离,增加抗锯齿处理\锐化处理\增强数字的边缘从而提升成功率
重构大富翁检查架构,減少一半冗余检查
补充战斗判断逻辑,规避卡在游戏战斗界面

v2.4.3
修复原地刷野重启问题
提高原地刷野效率
修复大富翁重启后没有点击标题问题

v2.4.2
增加原地刷野功能

v2.4.1
更新版本号从独立文件读取,防止修改端口复制文件,将版本号覆盖
更新ocr识别距离失败重试默认为4次,加快速度
增加ocr识别距离失败,保存失败图片,以便分析
更新暗月的拉豆子规则到默认配置
优化委托战斗前识别敌人逻辑

v2.4.0
优化整体的判断逻辑,加快大富翁里面响应的速度
修复重启后点击酒馆等菜单的bug

v2.3.5
修复2.3.4 中,路口识别异常的bug
修复2.3.4 中,整体速度慢的bug

v2.3.4
增加平均耗时统计
增加 部分日志
修改部分识别为图片
增强挂机稳定性,避免重启游戏后乱点与识别错误
优化大富翁识别逻辑,减少不必要的检查

v2.3.3
修改游戏盘增加自定义匹配敌人配置,由特征点改为图片匹配

v2.3.2
调整点击空白位置,避免卡路口

v2.3.1
游戏盘增加匹配敌人坐标的容差参数
游戏盘匹配敌人增加对应日志

v2.3.0
优化识别距离重试逻辑,增强准确度
游戏盘增加自定义匹配敌人配置
游戏盘增加自定义匹配敌人后,执行指令(目前只支持选中敌人,自定义战斗待完善)

v2.2.0
修复委托战斗点击逻辑,避免卡顿造成的重启与翻车
优化识别逻辑,增强识别距离准确度

v2.1.0
增加追忆之书功能,自定义战斗编辑系统

v1.9.0
增加历史日志功能
优化坐标采集逻辑

v1.8.0
优化启动逻辑
增加游戏盘扔骰子统计
打包ocr模型

v1.7.0
修复信息统计，翻车完成次数等
优化重试逻辑, 增强识别距离的成功率

v1.6.0
修复信息统计，翻车完成次数等
增强识别距离的成功率

v1.5.0
修复自定义规则重试次数不生效

v1.4.0
增加游戏盘自定义扔骰子设置
详情查看游戏盘配置文件
``` json
{
  "info_check_roll_rule_":"0-不使用自定义扔骰子规则,默认只投一次,1-使用自定义扔骰子规则",
  "info_bp":"[100,50,0],[50,30,1],[30,0,3]说明从100(包含)到50(不包含),使用0bp,从50(包含)到30(不包含)使用1bp,从30(包含)到0(包含)使用3bp",
  "info_check_roll_rule_time":"识别距离格子最大重试次数,默认5,识别成功1次立即结束",
  "info_check_roll_rule_wait":"扔骰子前等待时间,默认0.1,等待可以增加识别成功率,但会影响速度,自行调控",
  "check_roll_rule": "0",
  "check_roll_rule_time": "5",
  "check_roll_rule_wait": "0.1",
  "bp": {
      "801": "[100,0,3]",
      "802": "[100,0,0]",
      "803": "[100,0,0]"
  }
}
```
v1.3
优化巡检逻辑，每轮只截屏1次
开放巡检配置
config目录下monopoly.json
"isContinue": "0", 重启后是否继续游戏，目前如果检查还有问题，会卡住的话，建议0关闭
"check_interval": "0.2", 每轮巡检频率0.2秒
"check_roll_dice_time": "2", 丢出骰子后，加快动画点击次数，默认2
"check_roll_dice_interval": "0.2", 丢出骰子后，加快动画点击的间隔，默认0.2秒

v1.2
增加重启后是继续还是取消配置
增加是否输出日志配置
增加卡屏检查
优化扔骰子逻辑，减少丢出去的耗时

v1.1 
支持80权威游戏盘
支持80富足游戏盘
支持80名声游戏盘

#### 使用说明

1.  修改模拟器的分辨率为960x540
2.  在启动配置里修改adb port，雷电模拟器默认为127.0.0.1:5555，mumu模拟器默认为:127.0.0.1:16384

#### 战斗指令说明
- **BattleStart** - 战斗开始
- **BattleEnd** - 战斗结束，用来标记每场战斗的开始和结束。如果是子连战，可能需要标记多次。
- **Role,角色编号,技能编号,能量等级，敌人位置** - 控制角色使用指定技能攻击敌人。例子: `Role,1,2,3,x,y`，其中 x,y 是通过标记坐标按钮获取的敌人位置。
- **Boost** - 全体加成，提升所有角色的某些能力。
- **SwitchAll** - 全员交替，改变当前的战斗队形或角色顺序。
- **Attack** - 发起攻击，通常用于执行战斗命令。
- **Wait,500** - 等待500毫秒，用于控制动作间的时间延迟。
- **Skip,500** - 跳过500毫秒，用于快速跳过某些动作或等待。
- **Click,x,y** - 点击某个坐标，用来选中集火某个敌人。
- **SP,1(角色编号)** - 角色使用必杀技能，`SP,1` 表示第一个角色使用。
